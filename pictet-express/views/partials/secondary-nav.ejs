<div class="client-banker-line">
    <div class="banker-info">
        <div class="client-info">
            <span class="client-full" id="client-full-display">Client: </span>
        </div>
        <div class="banker-details">
            <% if (typeof user !== 'undefined' && user && user.type === 'banker') { %>
                <span class="banker-label">Private Banker:</span>
                <span class="banker-name" id="private-banker-name"><%= user.name %></span>
            <% } else if (typeof user !== 'undefined' && user && user.type === 'client') { %>
                <span class="banker-label">Private Banker:</span>
                <span class="banker-name" id="private-banker-name"><%= user.banker || 'Not Assigned' %></span>
            <% } else { %>
                <span class="banker-label">Private Banker:</span>
                <span class="banker-name" id="private-banker-name">Not Logged In</span>
            <% } %>
        </div>
    </div>
</div>

<style>
.client-banker-line {
    background-color: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
    padding: 0.5rem 1rem;
}

.banker-info {
    display: flex;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

.client-info {
    display: inline-block;
    white-space: nowrap;
}

.banker-details {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-left: auto;
    text-align: right;
}

.client-full, .banker-label {
    font-weight: 600;
    color: #495057;
    display: inline;
}

.banker-name {
    color: #212529;
    font-weight: 500;
    display: inline;
}
</style>

<script>
// Server-side user data (if available)
const serverUser = <% if (typeof user !== 'undefined' && user) { %><%- JSON.stringify(user) %><% } else { %>null<% } %>;

// This script populates the client name in the header
document.addEventListener('DOMContentLoaded', function() {
    const clientFullElement = document.getElementById('client-full-display');
    const clientInfoDiv = document.querySelector('.client-info');
    const currentPath = window.location.pathname;
    
    if (clientFullElement) {
        // Priority 1: If user is logged in as a client, show their name
        if (serverUser && serverUser.type === 'client') {
            clientFullElement.textContent = 'Client: ' + serverUser.name;
            clientInfoDiv.style.display = 'block';
        }
        // Priority 2: If user is a banker and has selected a client, show selected client
        else if (serverUser && serverUser.type === 'banker') {
            // Don't show client name on Client Alerts page
            if (currentPath === '/client-alerts') {
                clientInfoDiv.style.display = 'none';
            } else {
                const selectedClient = localStorage.getItem('selectedClient');
                if (selectedClient) {
                    // Extract just the name part before the hyphen
                    const clientName = selectedClient.split(' - ')[0].trim();
                    clientFullElement.textContent = 'Client: ' + clientName;
                    clientInfoDiv.style.display = 'block';
                } else {
                    clientInfoDiv.style.display = 'none';
                }
            }
        }
        // Priority 3: Fallback to localStorage for backward compatibility
        else {
            const clientName = localStorage.getItem('clientName');
            if (clientName) {
                clientFullElement.textContent = 'Client: ' + clientName;
                clientInfoDiv.style.display = 'block';
            } else {
                clientInfoDiv.style.display = 'none';
            }
        }
    }
});
</script> 